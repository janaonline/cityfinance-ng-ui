<div class="document-wrapper">
  <ng-content></ng-content>

  <table class="question-table">
    <tbody>
      <tr *ngFor="let question of questions; let i = index">
        <td>
          <p style="position: absolute; top: 1px; padding-top: 11px">
            {{ i + 1 }}.
          </p>
        </td>
        <td
          [ngClass]="{
            'documents-required':
              documentForm.controls[question.key].invalid && isSubmitButtonClick
          }"
        >
          <p class="question">
            <span [innerHTML]="question.question"></span>
            <span
              *ngIf="
                documentForm &&
                documentForm.controls[question.key] &&
                documentForm.controls[question.key].validator({})['required']
              "
              class="mandatory"
              >*</span
            >
          </p>
          <div *ngIf="canUploadFile">
            <div
              class="file-list"
              *ngFor="
                let file of userSelectedFiles[question.key];
                let i = index
              "
            >
              <span class="file-tracker-name">
                {{ file.name }}
              </span>
              <div
                class="progress"
                *ngIf="
                  fileUploadTracker[question.key] &&
                  fileUploadTracker[question.key][file.name]
                "
              >
                <div
                  class="progress-bar"
                  role="progressbar"
                  [ngStyle]="{
                    'width.%':
                      fileUploadTracker[question.key][file.name].percentage
                  }"
                  aria-valuenow="25"
                  aria-valuemin="0"
                  aria-valuemax="100"
                >
                  {{ fileUploadTracker[question.key][file.name].percentage }} %
                </div>
              </div>
              <a
                *ngIf="
                  (documents &&
                    documents[question.key] &&
                    documents[question.key][i]?.url) ||
                  (fileUploadTracker &&
                    fileUploadTracker[question.key] &&
                    fileUploadTracker[question.key][file.name].percentage ===
                      100 &&
                    fileUploadTracker[question.key][file.name]
                      ?.url) as downloadurl
                "
                [href]="downloadurl"
                class="download-link-icon"
                target="_blank"
              >
                <i
                  title="Download"
                  class="fa fa-cloud-download"
                  aria-hidden="true"
                ></i>
              </a>

              <span
                style="float: right; margin-left: 2%"
                *ngIf="canUploadFile && !documentForm.disabled"
              >
                <i
                  class="fa fa-times"
                  aria-hidden="true"
                  title="Remove"
                  (click)="cancelFileUpload(question.key, file.name)"
                ></i>
              </span>
            </div>
          </div>

          <div *ngIf="documents && !canUploadFile">
            <div
              class="file-list showList"
              *ngFor="let doc of documents[question.key] || []"
            >
              <span class="file-tracker-name"> {{ doc.name }}</span>
              <a [href]="doc.url" class="download-link-icon" target="_blank">
                <i
                  title="Download"
                  class="fa fa-cloud-download"
                  aria-hidden="true"
                ></i>
              </a>
            </div>
          </div>
        </td>

        <td>
          <button
            *ngIf="canUploadFile"
            class="myFile btn btn-primary"
            title="Select File/s"
            [disabled]="!canUploadFile"
          >
            Select File/s
            <input
              title="Select File/s"
              [id]="'fileUpload' + question.key"
              *ngIf="canUploadFile"
              [disabled]="!canUploadFile"
              type="file"
              accept=".pdf"
              [multiple]="noOfFilesAllowedPerQuestion > 1"
              (change)="fileChangeEvent($event, question.key)"
            />
          </button>
        </td>
      </tr>
      <tr>
        <td></td>
        <!-- <td colspan="3">
       
        </td> -->
        <td colspan="2">
          <div class="d-inline-flex justify-content-end" style="width: 100%">
            <button
              id="previous"
              class="btn btn-primary btn-upload mt-3"
              style="margin-right: 2%"
              (click)="previous.emit(true)"
            >
              Previous
            </button>
            <button
              id="save-as-Draft"
              *ngIf="canUploadFile && !documentForm.disabled"
              class="btn btn-primary btn-upload mt-3"
              style="margin-right: 2%"
              [disabled]="NoOfFileInProgress !== 0"
              (click)="onSaveAsDraftClick()"
            >
              Save as draft
            </button>
            <button
              id="next"
              class="btn btn-primary btn-upload mt-3"
              (click)="showNext.emit(true)"
              [disabled]="NoOfFileInProgress !== 0"
            >
              Next
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
