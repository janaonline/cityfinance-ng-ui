<div class="common-container">
  <div class="container">
    <div class="row">
      <div class="col-md-4" style="width: fit-content;">
        <h3 class="page-title" style="width: fit-content;">
          Municipal Bond Issuances
        </h3>
      </div>

      <form
        [formGroup]="filterForm"
        (ngSubmit)="onSubmittingFilterForm()"
        class="col-md-5 filterForm"
      >
        <angular2-multiselect
          style="width: 45%; margin-right: 2%;"
          formControlName="ulbs"
          [data]="ulbFilteredByName"
          [settings]="ulbDropdownConfiguration"
        >
        </angular2-multiselect>

        <angular2-multiselect
          style="width: 45%;margin-right: 2%"
          formControlName="years"
          [data]="yearsAvailable"
          [settings]="yearsDropdownSettings"
          (onClose)="onDateSelectionClose($event)"
          (onDeSelectAll)="unselectAllYears()"
        >
        </angular2-multiselect>
        <input type="submit" value="Search" class=" btn btn-primary" />
      </form>

      <div class="col-md-1" style="float: right;">
        <a href="/assets/files/MunicipalBondIssuances.xlsx">
          <button class="right btn btn-primary">Download</button>
        </a>
      </div>
    </div>

    <div class="row" style="overflow-x: auto;">
      <div class="col-md-12 municipal-bond">
        <table accordion-heading>
          <tr>
            <th>Issuer</th>
            <th *ngFor="let bondIsuuerItem of bondIssuerItemData">
              {{ bondIsuuerItem.ulb }}
            </th>
          </tr>
        </table>

        <accordion [closeOthers]="true" class="fixed-header" *ngIf="mainRows">
          <accordion-group
            class="table-responsive"
            *ngFor="let row of object.keys(mainRows)"
            [isOpen]="false"
          >
            <h4 accordion-heading class="text-capitalize">
              {{ formattedNamesMapping[row] }}
              <span class="fa fa-angle-down"></span>
            </h4>
            <table class="table table-striped accordion-body-table">
              <tr *ngFor="let subRow of mainRows[row]">
                <td class="text-capitalize somepadding">
                  {{ formattedNamesMapping[subRow] }}
                </td>
                <td
                  *ngFor="
                    let bondIsssuerItem of bondIssuerItemData;
                    let i = index
                  "
                  #i
                >
                  {{
                    bondIsssuerItem[subRow] | linkConverter: "click here...":i
                  }}
                </td>
              </tr>
            </table>
          </accordion-group>
        </accordion>
      </div>
    </div>
  </div>
</div>
