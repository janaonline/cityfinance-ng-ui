<mat-tab-group dynamicHeight="false" (selectedIndexChange)="tabIndexChangeHandler($event)" [selectedIndex]="tabIndex"
               class="mt-1"
               animationDuration="100ms">
  <mat-tab label='Extent on dependency on own revenues'>
    <ng-container *ngTemplateOutlet="table"></ng-container>
  </mat-tab>
  <mat-tab [label]="'Sources of revenue'">
    <ng-container *ngTemplateOutlet="table"></ng-container>
  </mat-tab>
  <mat-tab [label]="'Sources of financing revenue expenditure '">
    <div class="col-sm-12 col-md-5"></div>
    <div [style.minHeight.px]="400" [formGroup]="yearForm" class="col-md-7">
      <div class="row d-flex mt-4">
        <div class="col-sm-10">
          <angular2-multiselect
            class="m-0"
            formControlName="years"
            style="display: inline-block;width: 208px;"
            [data]="yearLookup"
            [settings]="yearsDropdownSettings"
            (onClose)="onDropdownClose($event)"
            (onSelect)="onDropdownSelect($event)"
            (onDeSelect)="onDropdownDeSelect($event)"
            (onSelectAll)="onDropDownSelectAll($event)"
            (onDeSelectAll)="resetPopupValues()">
          </angular2-multiselect>
        </div>
        <div class="col-sm-2">
          <button mat-stroked-button color="primary">View</button>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-12 d-flex" *ngFor="let data of commonTableDataDisplay">
          <div style="height: 33%;width: 33%" *ngFor="let row of data.data;let i=index">
            <canvas width="400px" height="400px" [id]="'canvas--'+data.year+'--'+i"></canvas>
          </div>
        </div>
        <ul class="legend"></ul>
      </div>
    </div>
  </mat-tab>
  <mat-tab [label]="'Avenues of revenue expenditure'">
    <ng-container *ngTemplateOutlet="table"></ng-container>
  </mat-tab>
  <mat-tab [label]="'Cash and Bank balance'">
    <ng-container *ngTemplateOutlet="table"></ng-container>
  </mat-tab>
  <mat-tab [label]="'Outstanding debt'">
    <ng-container *ngTemplateOutlet="table"></ng-container>
  </mat-tab>
</mat-tab-group>

<ng-template #table>
  <div [style.height.px]="400">
    <div class="col-sm-12 col-md-5">
      <app-re-useable-heat-map (ulbsClicked)="fetchUlBsData($event)"></app-re-useable-heat-map>
    </div>
    <div [formGroup]="yearForm" class="col-sm-12 col-md-7">
      <div class="row d-flex mt-4">
        <div class="col-sm-10">
          <angular2-multiselect
            class="m-0"
            formControlName="years"
            style="display: inline-block;width: 208px;"
            [data]="yearLookup"
            [settings]="yearsDropdownSettings"
            (onClose)="onDropdownClose($event)"
            (onSelect)="onDropdownSelect($event)"
            (onDeSelect)="onDropdownDeSelect($event)"
            (onSelectAll)="onDropDownSelectAll($event)"
            (onDeSelectAll)="resetPopupValues()">
          </angular2-multiselect>
        </div>
        <div class="col-sm-2">
          <button mat-stroked-button color="primary">View</button>
        </div>
      </div>
      <div class="row mt-2">
        <div class="col-sm-12 table-responsive">
          <table *ngIf="commonTableDataDisplay.length; else noData" class="table border-1">
            <thead>
            <tr>
              <th class="text-center col-sm-3 px-1 border-bottom-0" *ngFor="let header of commonTableHeaders">
                <div class="d-flex">
                  <div class="d-flex flex-column p-0">
                    {{header.title}}
                    <span class="font-weight-light" *ngIf="header.description">
                      {{header.description}}</span>
                  </div>
                  <i class="fa fa-sort px-1" aria-hidden="true"></i>
                </div>
              </th>
            </tr>

            </thead>
            <tbody>
            <ng-container *ngFor="let tr of commonTableDataDisplay">
              <tr>
                <td class="text-center" [colSpan]="commonTableHeaders.length"
                    [style.background]="'#ffc500'"><b>{{tr?.year}}</b></td>
              </tr>
              <tr *ngFor="let row of tr.data; let i=index">
                <td class="text-center" *ngFor="let col  of commonTableHeaders">{{row[col?.id]}}</td>
              </tr>
            </ng-container>
            </tbody>
          </table>
          <ng-template #noData>
            <div>No data available</div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</ng-template>


