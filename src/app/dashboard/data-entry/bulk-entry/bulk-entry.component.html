<div class="common-container">
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <h3>ULB Data Bulk Entry</h3>
      </div>
      <div class="col-md-6">
        <button [routerLink]="['../list']" class="right btn btn-primary">
          Entry List
        </button>
      </div>
    </div>
    <br />
    <span
      >Note* : Current version supports bulk data entry for single year
      only</span
    >
    <br />

    <div class="row">
      <form [formGroup]="bulkEntryForm" (ngSubmit)="upload()">
        <div class="col-md-4">
          <div class="form-group">
            <label>Financial Year</label>
            <select formControlName="year" class="form-control">
              <option *ngFor="let yr of years" [ngValue]="yr">{{ yr }}</option>
            </select>
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <label>Select files to upload</label>
            <input
              id="cin"
              name="cin"
              type="file"
              (change)="fileChangeEvent($event)"
              placeholder="Upload a file..."
              accept=".xls,.xlsx"
              multiple
            />
          </div>
        </div>
        <div class="col-md-4">
          <div class="form-group">
            <br />
            <button type="submit" class="btn btn-primary btn-s">Upload</button>
          </div>
        </div>
      </form>
    </div>

    <div class="row">
      <div class="col-sm-10">
        <ul class="list-group" type="1">
          <li
            class="list-group-item"
            *ngFor="let file of filesToUpload; let i = index"
          >
            <div>
              <div style="width: 50%; display: inline-block;">
                <div
                  style="width: fit-content; display: inline-block; margin-right: .5em;"
                >
                  {{ i + 1 }}.
                </div>
                {{ file.name }}
              </div>

              <!-- Normal Progress bar-->
              <div
                class="progress"
                *ngIf="fileProcessingTracker[i + 1]?.status === 'FAILED'"
              >
                <div
                  class="progress-bar uploadFailed"
                  role="progressbar"
                  style="width: 100%;"
                  [attr.aria-valuenow]="100"
                  aria-valuemin="0"
                  aria-valuemax="100"
                >
                  {{ fileProcessingTracker[i + 1]?.message }}
                </div>
              </div>

              <!-- Stripped progres bar for in processing-->
              <div
                class="progress"
                *ngIf="fileProcessingTracker[i + 1]?.status === 'in-process'"
              >
                <div
                  class="progress-bar progress-bar-striped active"
                  role="progressbar"
                  aria-valuenow="75"
                  aria-valuemin="0"
                  aria-valuemax="100"
                  style="width: 100%"
                >
                  {{ fileProcessingTracker[i + 1].message || "Processing..." }}
                </div>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
    <br /><br />
  </div>
</div>
