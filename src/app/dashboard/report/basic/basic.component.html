<div class="" *ngIf="isProcessed && reportKeys.length > 0">
  <div
    style="
      background: #059b9a !important;
      color: white;
      display: block;
      padding: 1%;
      max-width: 100%;
      position: relative;
    "
  >
    <br />

    <form
      [ngClass]="{ 'disable-form': reportReq.valueType === 'per_capita' }"
      [formGroup]="currenyConversionForm"
      style="
        width: 14%;
        display: inline-block;
        position: absolute;
        right: 1%;
        bottom: 9%;
      "
    >
      <angular2-multiselect
        formControlName="type"
        *ngIf="currencyConversionList && currencyConversionList.length"
        [data]="currencyConversionList"
        [settings]="conversionDropdownConfig"
        (onSelect)="onSelectingConversionType($event)"
        (onDeSelect)="onSelectingConversionType(null)"
        (onDeSelectAll)="onSelectingConversionType(null)"
      >
      </angular2-multiselect>
    </form>
    <p class="text-center" style="font-size: 1vw">
      {{ reportReq.type }} {{ reportReq.reportGroup }}
      <span *ngIf="reportReq.valueType === 'per_capita'">(Per Capita)</span>
    </p>
  </div>

  <div style="max-width: 100%">
    <table class="table-bordered">
      <thead>
        <tr></tr>

        <tr>
          <th class="text-center" style="background: white" colspan="2">
            Year(s)
          </th>
          <th
            class="text-center"
            style="background: white"
            *ngFor="let yr of years"
          >
            {{ yr.title }}
          </th>
        </tr>
        <tr>
          <th class="text-center">{{ reportReq.ulbList[0].state }}</th>
          <td *ngIf="!reportReq['ulbType']">{{ reportReq.ulbList[0].name }}</td>
          <td *ngIf="reportReq['ulbType']">All {{ reportReq["ulbType"] }}</td>
          <th class="text-center" *ngFor="let yr of years; let i = index">
            Population:
            {{
              reportReq.ulbList[0].population
                | inrCurrency: { currencyTypeInUser: null }
            }}
          </th>
        </tr>
        <tr>
          <th class="text-center">Account Code</th>
          <th class="text-center">Major Group/Minor Group</th>
          <th class="text-center" *ngFor="let yr of years">
            <!-- {{ reportReq.ulbList[0].state }} -->
          </th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let key of reportKeys"
          [ngClass]="{
            bold: report[key] && report[key].isBold,
            hidden: !report[key],
            backgroundHighlight:
              (report[key] &&
                report[key].line_item &&
                report[key].line_item.includes('Total')) ||
              (report[key] &&
                report[key].line_item &&
                report[key].line_item.includes('Net')) ||
              (report[key] &&
                report[key].line_item &&
                report[key].line_item.includes('Gross') &&
                key !== '410') ||
              (report[key] &&
                report[key].line_item &&
                report[key].line_item.includes('Net Surplus')) ||
              (report[key] &&
                report[key].line_item &&
                report[key].line_item.includes('Surplus/(Deficit) (C) (A-B)'))
          }"
        >
          <td class="text-center">{{ report[key] ? report[key].code : "" }}</td>
          <td
            [ngClass]="{
              'text-right':
                (report[key] &&
                  report[key].line_item &&
                  report[key].line_item.includes('Total')) ||
                (report[key] &&
                  report[key].line_item &&
                  report[key].line_item.includes('Net')) ||
                (report[key] &&
                  report[key].line_item &&
                  report[key].line_item.includes('Gross') &&
                  key !== '410') ||
                (report[key] &&
                  report[key].line_item &&
                  report[key].line_item.includes('Net Surplus')) ||
                (report[key] &&
                  report[key].line_item &&
                  report[key].line_item.includes('Surplus/(Deficit) (C) (A-B)'))
            }"
          >
            {{ report[key] ? report[key].line_item : "" }}
          </td>
          <td class="text-right" *ngFor="let yr of years">
            <span *ngIf="report[key]">
              <span *ngIf="report[key][yr.title] && !currencyTypeInUser">
                {{
                  report[key][yr.title]
                    | inrCurrency: { currencyTypeInUser: currencyTypeInUser }
                }}
              </span>

              <span
                *ngIf="report[key][yr.title] && currencyTypeInUser"
                [matTooltip]="
                  'INR ' +
                  (report[key][yr.title]
                    | inrCurrency: { currencyTypeInUser: null })
                "
              >
                {{
                  report[key][yr.title]
                    | inrCurrency: { currencyTypeInUser: currencyTypeInUser }
                }}
              </span>

              <span
                *ngIf="
                  (!report[key][yr.title] && report[key]['code']) ||
                  report[key][yr.title] === 0
                "
              >
                {{ report[key][yr.title] }}
              </span>

              <span
                *ngIf="
                  !report[key].isBold &&
                  (report[key][yr.title] === null ||
                    report[key][yr.title] === undefined)
                "
              >
                <span
                  *ngIf="
                    ((report[key] && report[key][yr.title] === undefined) ||
                      (report[key] && report[key][yr.title] === null)) &&
                    report[key]['allNullYear'] &&
                    report[key]['allNullYear'][yr.title]
                  "
                >
                  Data not available
                </span>

                <span
                  *ngIf="
                    report[key] &&
                    !report[key]['allNullYear'] &&
                    (report[key][yr.title] === undefined ||
                      report[key][yr.title] === null)
                  "
                >
                  0
                </span>
              </span>

              <span *ngIf="yr.isComparative">%</span>
            </span>
          </td>

          <!--<td *ngIf="'Comparative' == reportReq.type" class="text-right">{{ aggregate.Revenue['percentChange'] }}</td>-->
        </tr>
      </tbody>
    </table>
  </div>
</div>

<br />

<button
  (click)="download()"
  *ngIf="isProcessed && reportKeys.length > 0"
  class="btn btn-primary right"
>
  <i class="fa fa-file-text" aria-hidden="true"></i>

  Download XLS
</button>

<!-- <button
  class="btn btn-primary right source-file-download mr-2"
  (click)="routerTo()"
>
  Download Source File
</button> -->
