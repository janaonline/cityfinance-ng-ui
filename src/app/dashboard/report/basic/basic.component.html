<div class="row" *ngIf="isProcessed && reportKeys.length == 0">
  <!-- <div class="col-md-12">
    <h4 style="text-align: center">No Information Available</h4>
  </div> -->
</div>

<div class="row" *ngIf="isProcessed && reportKeys.length > 0">
  <!-- <div class="col-md-12" *ngFor="let item of report | keyvalue">{{item | json }}</div> -->
  <div
    style="background: #333; color: white; display: block; padding: 1%; max-width: 98%; position: relative;"
  >
    <img class="align-center" src="/assets/images/cityfinance-logo.png" />
    <br />
    <form
      [formGroup]="currenyConversionForm"
      style="width: 14%; display: inline-block; position: absolute; right: 1%; bottom: 9%;"
    >
      <angular2-multiselect
        formControlName="type"
        *ngIf="currencyConversionList && currencyConversionList.length"
        [data]="currencyConversionList"
        [settings]="conversionDropdownConfig"
        (onSelect)="onSelectingConversionType($event)"
        (onDeSelect)="onSelectingConversionType(null)"
        (onDeSelectAll)="onSelectingConversionType(null)"
      >
      </angular2-multiselect>
    </form>
    <p class="text-center">{{ reportReq.type }} {{ reportReq.reportGroup }}</p>
    <span
      *ngIf="currencyTypeInUser"
      style="color: white; position: absolute; bottom: 1%; left: 1%; font-style: italic;"
      id="currencyWarning"
    >
      <!-- Do not change the id of above span. we fetch this text dynamically from html using this id.-->
      <span style="color: red;">*</span> The following data is in
      {{ (currenyConversionForm?.value?.type)[0].name }} format. There could be
      some rounding off differences.
    </span>
  </div>

  <div style="max-width: 98%;">
    <table class="table-bordered">
      <thead>
        <tr></tr>

        <tr>
          <th class="text-center" colspan="2">Years</th>
          <th class="text-center" *ngFor="let yr of years">{{ yr.title }}</th>
        </tr>
        <tr>
          <th class="text-center">ULB</th>
          <td *ngIf="!reportReq.ulbType">{{ reportReq.ulbList[0].name }}</td>
          <td *ngIf="reportReq.ulbType">All {{ reportReq.ulbType }}</td>
          <th class="text-center" *ngFor="let yr of years">State</th>
          <!-- <td>{{ reportReq.ulbList[0].state }}</td> -->
        </tr>
        <tr>
          <th class="text-center">Account Code</th>
          <th class="text-center">Major Group/Minor Group</th>
          <th class="text-center" *ngFor="let yr of years">
            {{ reportReq.ulbList[0].state }}
          </th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let key of reportKeys"
          [ngClass]="{
            bold: report[key] && report[key].isBold,
            hidden: !report[key]
          }"
        >
          <td class="text-center">{{ report[key] ? report[key].code : "" }}</td>
          <td
            [ngClass]="{
              'text-right':
                (report[key] &&
                  report[key].line_item &&
                  report[key].line_item.includes('Total')) ||
                (report[key] &&
                  report[key].line_item &&
                  report[key].line_item.includes('Net')) ||
                (report[key] &&
                  report[key].line_item &&
                  report[key].line_item.includes('Gross') &&
                  key !== '410') ||
                (report[key] &&
                  report[key].line_item &&
                  report[key].line_item.includes('Net Surplus')) ||
                (report[key] &&
                  report[key].line_item &&
                  report[key].line_item.includes('Surplus/(Deficit) (C) (A-B)'))
            }"
          >
            {{ report[key] ? report[key].line_item : "" }}
          </td>
          <td class="text-right" *ngFor="let yr of years">
            <span *ngIf="report[key]">
              <span
                *ngIf="report[key][yr.title]"
                [ngClass]="{ tooltipWrapper: currencyTypeInUser }"
              >
                <span class="tooltipData" *ngIf="currencyTypeInUser">
                  {{
                    report[key][yr.title]
                      | inrCurrency: { currencyTypeInUser: null }
                  }}
                </span>
                {{
                  report[key][yr.title]
                    | inrCurrency: { currencyTypeInUser: currencyTypeInUser }
                }}
              </span>
              <span
                *ngIf="
                  (!report[key][yr.title] && report[key]['code']) ||
                  report[key][yr.title] === 0
                "
              >
                {{ report[key][yr.title] }}
              </span>

              <span
                *ngIf="
                  !report[key].isBold &&
                  (report[key][yr.title] === null ||
                    report[key][yr.title] === undefined)
                "
              >
                <span
                  *ngIf="
                    ((report[key] && report[key][yr.title] === undefined) ||
                      (report[key] && report[key][yr.title] === null)) &&
                    report[key]['allNullYear'] &&
                    report[key]['allNullYear'][yr.title]
                  "
                >
                  Data not available
                </span>

                <span
                  *ngIf="
                    report[key] &&
                    !report[key]['allNullYear'] &&
                    (report[key][yr.title] === undefined ||
                      report[key][yr.title] === null)
                  "
                >
                  0
                </span>
              </span>

              <span *ngIf="yr.isComparative">%</span>
            </span>
          </td>

          <!--<td *ngIf="'Comparative' == reportReq.type" class="text-right">{{ aggregate.Revenue['percentChange'] }}</td>-->
        </tr>

        <!-- <tr *ngFor="let item of report | keyvalue">
          <td class="text-center">{{ item.value.code }}</td>
          <td>{{ item.value.line_item }} - {{item.value.head_of_account}}</td>
          <td class="text-right" *ngFor="let yr of years">
            <span *ngIf="item.value[yr.title]">{{ item.value[yr.title] | inrCurrency}}</span>
            <span *ngIf="!item.value[yr.title]">0</span>
            <span *ngIf="yr.isComparative">%</span>
          </td>
        </tr> -->
      </tbody>
    </table>
  </div>
</div>

<br />
<button
  (click)="download()"
  *ngIf="isProcessed && reportKeys.length > 0"
  class="btn btn-primary right"
>
  Download
</button>
